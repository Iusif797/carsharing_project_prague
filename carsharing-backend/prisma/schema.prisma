datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id              String    @id @default(uuid())
  email           String    @unique
  password        String
  name            String
  phoneNumber     String?
  driversLicense  String?
  role            Role      @default(USER)
  isActive        Boolean   @default(true)
  totalTrips      Int       @default(0)
  totalSpent      Decimal   @default(0) @db.Decimal(10, 2)
  memberSince     DateTime  @default(now())
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  
  bookings        Booking[]
  trips           Trip[]
  reviews         Review[]
  
  @@map("users")
}

model Vehicle {
  id              String    @id @default(uuid())
  name            String
  brand           String
  model           String
  year            Int
  licensePlate    String    @unique
  city            String
  latitude        Decimal   @db.Decimal(10, 8)
  longitude       Decimal   @db.Decimal(11, 8)
  status          VehicleStatus @default(AVAILABLE)
  batteryLevel    Int       @default(100)
  fuelLevel       Int       @default(100)
  pricePerMinute  Decimal   @db.Decimal(10, 2)
  pricePerHour    Decimal   @db.Decimal(10, 2)
  pricePerDay     Decimal   @db.Decimal(10, 2)
  pricePerWeek    Decimal   @db.Decimal(10, 2)
  fuelType        String
  transmission    String
  seats           Int
  imageUrl        String?
  rating          Decimal   @default(5.0) @db.Decimal(3, 2)
  totalTrips      Int       @default(0)
  isActive        Boolean   @default(true)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  
  bookings        Booking[]
  trips           Trip[]
  reviews         Review[]
  
  @@map("vehicles")
}

model Booking {
  id              String    @id @default(uuid())
  userId          String
  vehicleId       String
  pricingPlan     PricingPlan
  totalPrice      Decimal   @db.Decimal(10, 2)
  status          BookingStatus @default(ACTIVE)
  startTime       DateTime
  endTime         DateTime?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  
  user            User      @relation(fields: [userId], references: [id])
  vehicle         Vehicle   @relation(fields: [vehicleId], references: [id])
  
  @@map("bookings")
}

model Trip {
  id              String    @id @default(uuid())
  userId          String
  vehicleId       String
  startTime       DateTime
  endTime         DateTime
  startLatitude   Decimal   @db.Decimal(10, 8)
  startLongitude  Decimal   @db.Decimal(11, 8)
  endLatitude     Decimal   @db.Decimal(10, 8)
  endLongitude    Decimal   @db.Decimal(11, 8)
  distance        Decimal   @db.Decimal(10, 2)
  duration        Int
  cost            Decimal   @db.Decimal(10, 2)
  createdAt       DateTime  @default(now())
  
  user            User      @relation(fields: [userId], references: [id])
  vehicle         Vehicle   @relation(fields: [vehicleId], references: [id])
  
  @@map("trips")
}

model Review {
  id              String    @id @default(uuid())
  userId          String
  vehicleId       String
  rating          Int
  comment         String?
  createdAt       DateTime  @default(now())
  
  user            User      @relation(fields: [userId], references: [id])
  vehicle         Vehicle   @relation(fields: [vehicleId], references: [id])
  
  @@map("reviews")
}

enum Role {
  USER
  ADMIN
}

enum VehicleStatus {
  AVAILABLE
  BOOKED
  IN_USE
  MAINTENANCE
  UNAVAILABLE
}

enum BookingStatus {
  ACTIVE
  COMPLETED
  CANCELLED
}

enum PricingPlan {
  PER_MINUTE
  HOURLY
  DAILY
  WEEKLY
}
